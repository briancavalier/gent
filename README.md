# Generative Testing

Gent is a generative testing tool for JavaScript in the same vein as Haskell [QuickCheck](http://en.wikipedia.org/wiki/QuickCheck).

Enumerating test cases by hand can be tedious and error prone. Using gent, you describe a scenario, and gent will generate the test inputs and verify the output produced by each using an assertion you provide.

## Get it

```js
npm install gent
```

## Example

Say you've written a function to (do something):

```js
// TODO: Example function to test
```

And you write a test in typical BDD style:

```js
describe('', function() {

	it('should', function() {

		// TODO: Example test

	});
});
```

And of course, the test passes.  Great.

Then later, your application breaks:

## Writing claims

To use gent, you write a claim.  A claim is an assertion about an invariant.  Then, you describe a set inputs

## Testing claims

Gent provides test adapters that allow it to integrate with other testing tools.  It also provides a simple `check` adapter that can be used in any testing environment that supports assertions that `throw`.

Currently, gent provides a test adapter for Buster.JS. Test adapters are simple (the [Buster.JS adapter](test-adapter/buster.js) is about 50 lines), so if you use another testing environment, please let us know, or better yet, send a pull request!

### Buster.JS

Gent's Buster.JS test adapter adds `buster.assert.claim` and `buster.refute.claim`, and integrates with `buster.referee`, so you'll get proper assertion counting, integrated test failure/error reporting, etc.

#### Setup

In your `buster.js` config, add:

```js
require('gent/test-adapter/buster');
```

#### Testing claims

Use `buster.assert.claim` or `buster.refute.claim` in your test cases.  For example:

```js
buster.testCase('', {

	'should': function() {

		// TODO: Example

	}

});
```

### Assertions

The `gent/test-adapter/check` adapter can be used in any testing environment that supports throwing Errors to indicate test failures.

In your tests, import `gent` and `gent/test-adapter/check`:

```js
var gent = require('gent');
var check = require('gent/test-adapter/check');

// For example, using typical BDD style
describe('', function() {

	it('should', function() {

		// TODO: Example

	});

});
```

## API

### Creating claims

#### gent.claim

```js
var claim = gent.claim(invariantAssertion, ...args);

var claim = gent.claim(description, invariantAssertion, ...args);
```

Create a claim that will check the provided `invariantAssertion` passing inputs generated by the supplied list of `args` generators.  The claim can be checked with any of the [test adapters](#testingclaims).

```js
// Make sure Math.max works by throwing a bunch of random numbers at it
// The invariants are
// 1. It will return either x or y
// 2. The value returned will be the larger of the two

var returnsMaxValue = gent.claim(function(x, y) {
	var max = Math.max(x, y);
	return (max === x && x >= y) || (max === y && y >= x);
}, gent.number(), gent.number());
```

Optionally, you can provide a description of the claim:

```js
var returnsMaxValue = gent.claim('Math.max returns max value', function(x, y) {
	var max = Math.max(x, y);
	return (max === x && x >= y) || (max === y && y >= x);
}, gent.number(), gent.number());
```

### Generating inputs

#### gent.number

```js
gent.number();
gent.number(min);
gent.number(min, max);
```

#### gent.number.positive

```js
gent.number.positive();
gent.number.positive(max);
```

#### gent.number.negative

```js
gent.number.negative();
gent.number.negative(min);
```

#### gent.integer

```js
gent.integer();
gent.integer(min);
gent.integer(min, max);
```

#### gent.integer.positive

```js
gent.integer.positive();
gent.integer.positive(max);
```

#### gent.integer.negative

```js
gent.integer.negative();
gent.integer.negative(min);
```

#### gent.counter

```js
gent.counter();
gent.counter(start);
gent.counter(start, step);
```

#### gent.string

```js
gent.string();
gent.string(len);
gent.string(len, characters);
```

#### gent.char

```js
gent.char();
gent.char(characters);
gent.char(low);
gent.char(low, high);
```

#### gent.bool

```js
gent.bool();
gent.bool(chance);
```

#### gent.truthy

```js
gent.truthy();
```

#### gent.falsy

```js
gent.falsy()
```

#### gent.any

```js
gent.any();
```

#### gent.array

```js
gent.array();
gent.array(len);
gent.array(len, itemGenerator);
gent.array(templateArray);
```

#### gent.object

```js
gent.object();
gent.object(numberOfKeys);
gent.object(numberOfKeys, keyGenerator);
gent.object(numberOfKeys, keyGenerator, valueGenerator);
```

#### gent.object.template

```js
gent.object.template(templateObject);
```

#### gent.pick

```js
gent.pick(generator1, generator2, ...);
gent.pick(arrayOfGenerators);
```

#### gent.sequence

```js
gent.sequence(arrayOfGenerators);
```
